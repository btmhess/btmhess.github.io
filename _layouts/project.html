---
layout: default
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{ page.title }} | My Projects Portfolio</title>
  <link rel="stylesheet" href="/assets/css/style.css">
</head>
<body>

<header>
  <nav style="display:flex; align-items:center; justify-content:space-between; padding:1rem; background:#f5f5f5; border-bottom:1px solid #ddd;">
    <div>
      <a href="/" style="margin-right:1rem;">Home</a>
      <a href="/index.html">Projects</a>
    </div>
    <h1 style="margin:0;">{{ page.title }}</h1>
  </nav>
</header>

<main style="padding:1rem; max-width:960px; margin:auto;">

  <!-- Banner image (first image in project folder) -->
  {% assign project_folder = "assets/projects/" | append: page.project_slug | append: "/" %}
  {% assign project_images = site.static_files | where_exp: "f", "f.path contains project_folder" | sort: "path" %}

  {% if project_images.size > 0 %}
    <div style="text-align:center; margin-bottom:1rem;">
      <img src="{{ project_images[0].url }}" alt="{{ page.title }} banner" style="max-width:100%; border-radius:4px;">
    </div>
  {% endif %}

  <!-- Project metadata -->
  <section>
    <p><strong>Goal:</strong> {{ page.goal }}</p>

    <h2>Requirements</h2>
    <p>{{ page.requirements }}</p>

    <h2>Result / Current Incarnation</h2>
    <p>{{ page.result }}</p>

    <h2>Specifications</h2>
    <p>{{ page.specifications }}</p>
  </section>

  <!-- Gallery of remaining images -->
  {% assign gallery_images = project_images | slice:1, project_images.size %}
  {% if gallery_images.size > 0 %}
    <h2>Gallery</h2>
    <div class="gallery">
      {% for file in gallery_images %}
        {% if file.extname == ".jpg" or file.extname == ".jpeg" or file.extname == ".png" or file.extname == ".webp" %}
          <img src="{{ file.url }}" alt="">
        {% endif %}
      {% endfor %}
    </div>
  {% endif %}

  <!-- Materials table -->
  <h2>Materials / Parts List</h2>
  <div id="materials-table">
    <em>Loading materials listâ€¦</em>
  </div>

  <script>
  (async function () {
    const container = document.getElementById("materials-table");
    const projectSlug = "{{ page.project_slug }}";
    const csvUrl = "/assets/projects/" + projectSlug + "/materials.csv";

    try {
      const response = await fetch(csvUrl);
      if (!response.ok) throw new Error("No materials.csv found");

      const text = await response.text();
      const rows = text.trim().split("\n").map(r => r.split(","));

      const table = document.createElement("table");
      const thead = document.createElement("thead");
      const tbody = document.createElement("tbody");

      // Header
      const headerRow = document.createElement("tr");
      rows[0].forEach(h => {
        const th = document.createElement("th");
        th.textContent = h.trim();
        headerRow.appendChild(th);
      });
      thead.appendChild(headerRow);

      // Body
      rows.slice(1).forEach(row => {
        const tr = document.createElement("tr");
        row.forEach(cell => {
          const td = document.createElement("td");
          td.textContent = cell.trim();
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });

      table.appendChild(thead);
      table.appendChild(tbody);

      container.innerHTML = "";
      container.appendChild(table);
    } catch (err) {
      container.innerHTML = "<em>No materials list available.</em>";
      console.warn("Materials table load failed:", err);
    }
  })();
  </script>

  <!-- Related projects -->
  {% if page.related %}
    <h2>Related Projects</h2>
    <ul>
      {% for r in page.related %}
        <li><a href="{{ r.url }}">{{ r.title }}</a></li>
      {% endfor %}
    </ul>
  {% endif %}

</main>

<style>
/* Gallery styling */
.gallery {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.gallery img {
  width: 100%;
  height: auto;
  border: 1px solid #ccc;
  border-radius: 4px;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 2rem;
}
th, td {
  border: 1px solid #ccc;
  padding: 0.4rem;
  text-align: left;
}
th {
  background-color: #eee;
}
</style>

</body>
</html>
